<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Users List - Homovaty</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.5s ease;
        }
        body.dark-mode {
            background-color: #121212;
        }
        .users-container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 800px;
            text-align: center;
            transition: background-color 0.5s ease, box-shadow 0.3s ease;
        }
        .users-container.dark-mode {
            background-color: #1f1f1f;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        h1 {
            color: #007BFF;
            margin-bottom: 20px;
            transition: color 0.3s ease;
        }
        h1.dark-mode {
            color: #64b5f6;
        }
        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        li {
            margin-bottom: 15px;
            border-bottom: 1px dashed #ddd;
            padding-bottom: 10px;
            transition: border-bottom 0.3s ease;
        }
        li.dark-mode {
            border-bottom: 1px dashed #444;
        }
        li:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        .user-link {
            color: #007BFF;
            text-decoration: none;
            font-size: 18px;
            font-weight: 500;
            transition: color 0.3s ease, font-weight 0.3s ease;
        }
        .user-link:hover {
            color: #0056b3;
            font-weight: 600;
        }
        .user-link.dark-mode {
            color: #81d4fa;
        }
        .user-link.dark-mode:hover {
            color: #e0f7fa;
        }
        #no-users {
            color: #666;
            font-style: italic;
            transition: color 0.3s ease;
            margin-top: 20px;
        }
        #no-users.dark-mode {
            color: #999;
        }
        .back-button {
            display: block;
            margin-top: 30px;
            color: #007BFF;
            text-decoration: none;
            font-size: 16px;
            transition: color 0.3s ease;
        }
        .back-button:hover {
            color: #0056b3;
            text-decoration: underline;
        }
        .back-button.dark-mode {
            color: #81d4fa;
        }
        .back-button.dark-mode:hover {
            color: #e0f7fa;
        }
        .loading-indicator {
            margin-top: 20px;
            font-size: 18px;
            color: #888;
            transition: color 0.3s ease;
        }
        .loading-indicator.dark-mode {
            color: #bbb;
        }
    </style>
</head>
<body class="">
    <div class="users-container ">
        <h1 class="">Registered Users</h1>
        <ul id="users-list">
            <li class="loading-indicator">Loading users...</li>
        </ul>
        <p id="no-users" class="hidden">No users found.</p>
        <a href="index.html" class="back-button ">Back to Home</a>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script>
       // Firebase configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "roommateapp-3eb62.firebaseapp.com",
            projectId: "roommateapp-3eb62",
            storageBucket: "roommateapp-3eb62.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "1:YOUR_APP_ID:web:YOUR_WEB_APP_ID",
            databaseURL: "https://roommateapp-3eb62-default-rtdb.firebaseio.com"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const usersList = document.getElementById('users-list');
        const noUsersMessage = document.getElementById('no-users');
        const body = document.querySelector('body');
        const usersContainer = document.querySelector('.users-container');
        const h1 = document.querySelector('h1');
        const backButton = document.querySelector('.back-button');

        function applyDarkMode() {
            body.classList.add('dark-mode');
            usersContainer.classList.add('dark-mode');
            h1.classList.add('dark-mode');
            backButton.classList.add('dark-mode');
             const listItems = usersList.querySelectorAll('li');
            listItems.forEach(li => {
                li.classList.add('dark-mode');
            });
            const userLinks = usersList.querySelectorAll('.user-link');
            userLinks.forEach(link => {
                link.classList.add('dark-mode');
            });
             if (noUsersMessage) {
                noUsersMessage.classList.add('dark-mode');
            }
        }

        function removeDarkMode() {
            body.classList.remove('dark-mode');
            usersContainer.classList.remove('dark-mode');
            h1.classList.remove('dark-mode');
            backButton.classList.remove('dark-mode');
            const listItems = usersList.querySelectorAll('li');
            listItems.forEach(li => {
                li.classList.remove('dark-mode');
            });
             const userLinks = usersList.querySelectorAll('.user-link');
            userLinks.forEach(link => {
                link.classList.remove('dark-mode');
            });
            if (noUsersMessage) {
                noUsersMessage.classList.remove('dark-mode');
            }
        }

        // Check for user preference on page load
        const storedPreference = localStorage.getItem('darkMode');
        if (storedPreference === 'enabled') {
            applyDarkMode();
        }

        database.ref('users').once('value', snapshot => {
            usersList.innerHTML = ''; // Clear the "Loading..." message
            const users = snapshot.val();

            if (users) {
                let hasUsers = false;
                for (const uid in users) {
                    if (users[uid].username) { // Only show users with usernames
                        hasUsers = true;
                        const user = users[uid];
                        const li = document.createElement('li');
                        const userLink = document.createElement('a');
                        userLink.textContent = user.username;
                        userLink.href = `profile.html?uid=${uid}`;
                        userLink.className = 'user-link';
                        li.appendChild(userLink);
                        usersList.appendChild(li);
                    }
                }
                if (!hasUsers) {
                    noUsersMessage.classList.remove('hidden');
                }
            } else {
                noUsersMessage.classList.remove('hidden');
            }
        }).catch(error => {
            console.error("Error fetching users:", error);
            usersList.innerHTML = 'Error fetching users. Please try again later.'; // Display error message
        });
    </script>
</body>
</html>

